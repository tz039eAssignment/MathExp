clearvars

% from 1960 to 2020, a total of 61 years
num = [180671000 183691000 186538000 189242000 191889000 194303000 196560000 198712000 200706000 202677000 205052000 207661000 209896000 211909000 213854000 215973000 218035000 220239000 222585000 225055000 227225000 229466000 231664000 233792000 235825000 237924000 240133000 242289000 244499000 246819000 249623000 252981000 256514000 259919000 263126000 266278000 269394000 272657000 275854000 279040000 282162411 284968955 287625193 290107933 292805298 295516599 298379912 301231207 304093966 306771529 309327143 311583481 313877662 316059947 318386329 320738994 323071755 325122128 326838199 328329953 329484123];
num = num(1 : length(num)-1)

LAST_N = 20;
t = 0 : (LAST_N-1);
xx = num(length(num)-LAST_N+1 : length(num));

model = @(c, k, x_m, x) (c * exp(-k * x) + x_m);

f = fit(t(:), xx(:), model, fitoptions( ...
    Method='NonlinearLeastSquares',...
    StartPoint=[-1e8, 1e-10, 3e8]...
))

fitted_model = @(t) model(f.c, f.k, f.x_m, t);

fplot(fitted_model, [0 LAST_N-1])
hold on
plot(t, xx, '.')
hold off

(fitted_model(LAST_N) - 329484123) / 329484123
